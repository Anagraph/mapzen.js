!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.WebMap=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module){!function(hashable){"use strict";hashable.version="1.5.5",hashable.hash=function(loc){function change(){if(!writing){var url=loc.hash.substr(1);if(url!=current){var previous=data;data=parse.call(hash,url),!data&&valid.call(format,url)||!data&&def&&(data=def.call(hash,previous),hash.write(!0),url=loc.hash.substr(1));var diff=hashable.diff(previous,data);onchange.call(hash,{url:url,data:data,previous:previous,diff:diff}),current=url}}}loc||(loc=window.location);var current,hash={},data=null,format=hashable.format.path(),parse=format.parse,onchange=function(){},def=hashable.functor(null),valid=hashable.functor(!1),writing=!1;return hash.data=function(d){return arguments.length?(data=d,hash):data},hash.set=function(d){return"string"==typeof d?(loc.hash=d,hash):hash.data(d).write()},hash.update=function(d){return hashable.extend(data,d),hash},hash.write=function(silent){return silent&&(writing=!0),loc.hash=format(data),silent&&(writing=!1),hash},hash.read=function(){return change(),hash},hash.format=function(fmt){return arguments.length?("string"==typeof fmt&&(fmt=hashable.format(fmt)),format=fmt,"function"==typeof format.parse&&(parse=format.parse),hash):format},hash.parse=function(fn){return arguments.length?(parse=fn,hash):parse},hash.url=function(d,merge){return arguments.length||(d=data),merge&&(d=hashable.extend({},data,d)),"#"+format(d)},hash.enable=function(){return window.addEventListener("hashchange",change),hash},hash.disable=function(){return window.removeEventListener("hashchange",change),hash},hash.change=function(callback){return arguments.length?(onchange=callback,hash):onchange},hash.valid=function(f){return arguments.length?(valid=hashable.functor(f),hash):valid},hash.href=function(selection){selection.on("click.hashable",function(d){this.href=hash.url(d)})},hash.href.merge=function(selection){selection.on("click.hashable",function(d){this.href=hash.url(d,!0)})},hash.href.parse=function(){return parse(this.getAttribute("href").substr(1))},hash.check=function(){return loc.hash?hash.read():(onchange.call(hash,{previous:null,data:data||(data=def.call(hash)),diff:hashable.diff({},data)}),hash.write())},hash["default"]=function(d){return arguments.length?(def=hashable.functor(d),hash):def},hash},hashable.validFragment=function(fragment){return!!document.getElementById(fragment)},hashable.format=function(fmt){var query=!1;fmt?"?"===fmt.charAt(fmt.length-1)&&(query=!0,fmt=fmt.substr(0,fmt.length-1)):fmt="";var keys=[],word="([-\\w\\.]+)",wordPattern=new RegExp("{"+word+"}","g"),pattern=new RegExp("^"+fmt.replace(wordPattern,function(_,key){return keys.push(key),word})+"$"),format=function(data){data||(data={});var str=fmt.replace(wordPattern,function(_,key){return data[key]});if(!query)return str;var qkeys=Object.keys(data).filter(function(key){return-1===keys.indexOf(key)});return qkeys.length?[str,hashable.qs.format(hashable.copy(data,qkeys))].join("?"):str};return format.match=function(str){return query&&(str=str.split("?",2)[0]),str.match(pattern)},format.parse=function(str){var qdata;if(query){var bits=str.split("?",2);if(str=bits[0],qdata=hashable.qs.parse(bits[1]))if(Array.isArray(query))qdata=hashable.copy(qdata,query);else{var qkeys=Object.keys(qdata).filter(function(key){return-1===keys.indexOf(key)});qdata=hashable.copy(qdata,qkeys)}}var match=format.match(str);if(match){var data={};return keys.forEach(function(key,i){data[key]=match[i+1]}),qdata&&hashable.extend(data,qdata),data}return null},format.query=function(q){return arguments.length?(query=q,format):query},format.toString=function(){return fmt},format},hashable.format.path=function(){var format=function(data){data=hashable.extend({},data);var path=data.path||"";delete data.path;var query=hashable.qs.format(data);return query?[path,query].join("?"):path};return format.match=function(){return!0},format.parse=function(str){var bits=str.split("?",2),data={path:bits[0]};if(bits.length>1){var query=hashable.qs.parse(bits[1]);if(query)return hashable.extend(data,query)}return data},format},hashable.format.map=function(f){var fmt=hashable.format(f||"{z}/{y}/{x}").query(!0),precision=function(z){return Math.max(0,Math.ceil(Math.log(z)/Math.LN2))},format=function(data){if(data&&!hashable.empty(data.z)){var p=precision(+data.z);data.x=(+data.x).toFixed(p),data.y=(+data.y).toFixed(p)}return fmt(data)};return format.match=function(str){return fmt.match(str)},format.parse=function(str){var parsed=fmt.parse(str);return parsed&&(parsed.z=+parsed.z,parsed.x=+parsed.x,parsed.y=+parsed.y,isNaN(parsed.z)||isNaN(parsed.x)||isNaN(parsed.y))?null:parsed},format.query=function(q){return arguments.length?(fmt.query(q),fmt):fmt.query()},format.precision=function(p){return arguments.length?(precision=hashable.functor(p),format):precision},format},hashable.qs=function(){function encode(d){return encodeURIComponent(d).replace(/(\%[A-F0-9]{2})/g,function(_,hex){return hex in replacements?replacements[hex]:hex})}function decode(str){return decodeURIComponent(str.replace(/\+/g," "))}var qs={separator:"&"},replacements=qs.replacements={"%20":"+","%2C":","};return qs.parse=function(str){if(!str||"?"===str)return null;"?"===str.charAt(0)&&(str=str.substr(1));var data={};return str.split(qs.separator).forEach(function(bit){var parts=bit.split("="),key=decode(parts[0]),val=bit.substr(key.length+1);data[key]=1===parts.length||"true"===val?!0:"false"===val?!1:decode(val)}),data},qs.format=function(data,sortKeys){if("string"==typeof data)return data;if(null===data||"undefined"==typeof data)return"";var keys=Object.keys(data).filter(function(key){return!hashable.empty(data[key])});sortKeys&&(keys=keys.sort(function(a,b){return a>b?1:b>a?-1:0}));var bits=keys.map(function(key){return data[key]===!0?key:[key,encode(data[key])].join("=")});return bits.length?bits.join(qs.separator):""},qs}(),hashable.extend=function(a){return[].slice.call(arguments,1).forEach(function(o){if(o)for(var key in o)a[key]=o[key]}),a},hashable.diff=function(a,b){for(var key,i,ak=Object.keys(a||{}),bk=Object.keys(b||{}),diff={};ak.length;)key=ak.shift(),i=bk.indexOf(key),-1===i?diff[key]={op:"remove",value:a[key]}:b[key]!=a[key]?(diff[key]={op:"change",value:[a[key],b[key]]},bk.splice(i,1)):bk.splice(i,1);for(;bk.length;)key=bk.shift(),diff[key]={op:"add",value:b[key]};return Object.keys(diff).length>0?diff:null},hashable.copy=function(obj,keys){var copy={};return keys.forEach(function(key){key in obj&&(copy[key]=obj[key])}),copy},hashable.empty=function(d){return null===d||"undefined"==typeof d||0===d.length},hashable.functor=function(d){return"function"==typeof d?d:function(){return d}},"object"==typeof L&&(L.Hash=L.hash=function(){var moveend,zoomend,viewreset,hash=hashable.hash().format(hashable.format.map()).enable(),changed=!1;return hash.onAdd=function(map){hash.change(function(e){var view=e.data;view&&(map.setView([view.y,view.x],view.z,changed?null:{animate:!1}),changed=!0,map.fireEvent("hashchange",e))})["default"](function(){return{z:map.getZoom(),x:map.getCenter().lng,y:map.getCenter().lat}}).enable(),map.on("moveend",moveend=function(){var c=map.getCenter();hash.update({x:c.lng,y:c.lat}).write()}).on("zoomend",zoomend=function(){var z=map.getZoom();hash.update({z:z}).write()}).on("viewreset",viewreset=function(){var c=map.getCenter(),z=map.getZoom();hash.update({x:c.lng,y:c.lat,z:z}).write()})},hash.onRemove=function(map){hash.change(null).disable(),map.off("moveend",moveend).off("zoomend",zoomend).off("viewreset",viewreset)},hash.addTo=function(map){return map.addLayer(hash),hash},hash})}("object"==typeof module?module.exports:this.hashable={})},{}],2:[function(require,module){"use strict";module.exports=function(){var t,e=require("hashable"),a={init:function(e,a,n){return t=L.map(e).setView(a,n),t.doubleClickZoom.disable(),t.on("dblclick",function(e){t.setView(e.latlng,t.getZoom()+1)}),t.scrollWheelZoom=this._isThisIframed(),this._setupHash(),this},_setupHash:function(){var a=e.hash().change(function(e){var a=e.data;t.setView([a.lat,a.lng],a.z)})["default"](function(){var a=e.format.path(),n=a.parse(window.location.hash);return{z:n.z||t.getZoom(),lng:n.lng||t.getCenter().lng,lat:n.lat||t.getCenter().lat}}).enable().check();t.on("moveend",function(){var o=t.getCenter(),r=e.format.path(),i=n(a.data().z);a.update({lng:o.lng.toFixed(i),lat:o.lat.toFixed(i)});var l=r(a.data());window.history.replaceState({},null,"#"+l)}).on("zoomend",function(){a.update({z:t.getZoom()});var n=e.format.path(),o=n(a.data());window.history.replaceState({},null,"#"+o)});var n=function(t){return Math.max(0,Math.ceil(Math.log(t)/Math.LN2))}},setupScene:function(e){this._hasWebGL()?Tangram.leafletLayer({scene:e,attribution:'<a href="https://mapzen.com/tangram" target="_blank">Tangram</a> | &copy; OSM contributors | <a href="https://mapzen.com/" target="_blank">Mapzen</a>'}).addTo(t):(console.log("WebGL is not available, falling back to OSM default tile."),L.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://openstreetmap.org/copyright">OpenStreetMap contributors</a>'}).addTo(t))},getLeafletMap:function(){return t},_hasWebGL:function(){try{var t=document.createElement("canvas");return!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(e){return!1}},_isThisIframed:function(){return window.self!==window.top}};return a}()},{hashable:1}]},{},[2])(2)});